@model List<CartVM>
<form class="form-control" method="post" enctype="multipart/form-data">
	<section class="h-100 h-custom" style="background-color: #eee;">
  <div class="container py-5 h-100">
	<div class="row d-flex justify-content-center align-items-center h-100">
	  <div class="col">
		<div class="card">
		  <div class="card-body p-4">

			<v class="row">

			  <div class="col-lg-12">
				<a class="text-body" asp-action="Index" asp-controller="Home"><h5>Continue Shopping</h5></a>
				<hr>

				<div class="d-flex justify-content-between align-items-center mb-4">
				  <div>
					<p class="mb-1">Shopping cart</p>
					<p class="mb-0">You have @(Model.Count()) items in your cart</p>
				  </div>
				</div>
				@{
						@foreach(var obj in Model){
							<div class="card mb-3 mb-lg-0">
								<div class="card-body">
									<div class="d-flex justify-content-between">
										<div class="d-flex flex-row align-items-center">
												<div>
												@{
													string imgUrl = obj.Products.UrlImage;
												}
												  <img
													src="@imgUrl"
													class="img-fluid rounded-3" alt="Shopping item" style="width: 65px;">
												</div>
												<div class="ms-3">
												  <h5>@obj.Products.Title</h5>
												  <p class="small mb-0">@obj.Products.Author</p>
												</div>
										</div>
										<div class="d-flex flex-row align-items-center ">
											<div>
													<div class="m-4">
														<h5 id="currentCnt" class="mb-0">@obj.Count</h5>
													</div>
											</div>
											<div style="width:60px; margin-right:20px;" class="row">

													
														<button class="btn border-0 col-6" id="increase">
															<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-plus-fill" viewBox="0 0 16 16">
															  <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM8.5 6v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 1 0z"/>
															</svg>
														</button>
														<button class="btn border-0 col-6" id="decrease">
															<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-minus-fill" viewBox="0 0 16 16">
															  <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM6 7.5h4a.5.5 0 0 1 0 1H6a.5.5 0 0 1 0-1z"/>
															</svg>
														</button>
													
											</div>
											<div style="width: 120px;">
												@{
													
													string price = Convert.ToString(obj.Products.Price * obj.Count);
													string tmp = "";
													int cnt = 0;
													for(int i = price.Length - 1; i >= 0;i--){
														if(cnt == 3){
															cnt = 1;
															tmp += '.';
														}
														else{
															cnt++;
														}
														tmp += price[i];
													}
													string res = "";
													for(int i = tmp.Length - 1;i >= 0;i--){
														res += tmp[i];
													}
													res += ".000";
												}
														
												<h5 class="mb-0" id="PriceItem">@res</h5>
											</div>
											<div>
													@{
														string url = $"/Customer/Cart/Delete/{obj.shoppingCartId}";
													}
													<a class="btn btn-danger" onclick="Delete('url')">
														<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
															<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
															<path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
														</svg>													
													</a></div>
										</div>
									</div>
								</div>
							</div>
						}
						
				}

			  </div>

		  </div>
		</div>
	  </div>
	</div>
  </div>
</section>
</form>

<script>
	function Delete(url) {
		Swal.fire({
			title: 'Are you sure?',
			text: "You won't be able to revert this!",
			icon: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#3085d6',
			cancelButtonColor: '#d33',
			confirmButtonText: 'Yes, delete it!'
		}).then((result) => {
			if (result.isConfirmed) {
				$.ajax({
					url: url,
					type: 'DELETE',
					success: function (data) {
						if (data.success) {
							Swal.fire(
								location.reload(),
								'Deleted!',
								'Your file has been deleted.',
								'success'
							)
						}
						else {
							Swal.fire(
								'Deleted!',
								'Your your file can not deleted.',
							)
						}
					}
				})
			}
		})
	}
	var currentCnt = Number(document.getElementById("currentCnt").innerHTML);
	document.getElementById("increase").onclick = function(){
		currentCnt++;
		document.getElementById("currentCnt").innerHTML = currentCnt;
	}
</script>
